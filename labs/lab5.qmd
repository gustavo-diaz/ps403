---
title: "Lab 5: Maximum likelihood estimation"
author: 
  - FirstName LastName
  - <YourEmail@u.northwestern.edu>
date: November 4, 2024
date-format: "**[D]ue:** MMMM D, YYYY"
format: 
     pdf:
       documentclass: article
fontsize: 12pt
urlcolor: blue
number-sections: true
geometry:
      - left=1in
      - right=1in
      - top=1in
      - bottom=1in
header-includes:
    - \usepackage{setspace}
    - \doublespacing
---

```{r setup, include=FALSE}
# Code chunk options
knitr::opts_chunk$set(echo = TRUE, 
                      warning = FALSE,
                      message = FALSE,
                      tidy = FALSE,
                      tidy.opts=list(width.cutoff=80))

# Packages
library(tidyverse)
library(marginaleffects) # Visualize regression output
library(modelsummary) # make pdf regression tables
library(car) # Includes data
library(mvtnorm) ##  a package for the multivariate normal distribution

```


# Data

The `Chile` data frame contains observations from a national survey conducted in April and May of 1988 by FLACSO/Chile. 

[Explain more based on the Fox book]

```{r, eval = FALSE}
# Explore but do not print in pdf
Chile
```

Each variable measures the following

- `vote`: Outcome
- `statusquo`: Main explanatory variable
- `income`:
- `education`:
- `age`:
- `sex`: 
- `population`:
- `region`:

We will recode our outcome variable as a binary indicator for whether people indicate they will vote "Yes" (in favor of keeping military rule).

```{r}
chile = Chile %>% drop_na

chile$yes = ifelse(chile$vote == "Y", 1, 0)

# check
with(chile, table(vote, yes))
```


# Maximum likelihood estimation

<!-- MLE by hand, then gaussian -->
<!-- https://github.com/gustavo-diaz/531-explorations/blob/spring2021/exploration8MLE2.Rmd --> -->


```{r}
ols_ll = function(theta, y, X){
  betas = theta [1:ncol(X)]
  sigma2 = theta[ncol(X) + 1]
  mu = X %*% betas
  n = length(y)
  sigma_mat = sigma2 * diag(n)
  ll = - dmvnorm(t(y), mu, sigma_mat, log = TRUE)
}
```


# Classical linear model

Consider the following model:

[MODEL]

Assuming this model is true, we can estimate the parameters $\theta$.

# Logistic regression

# Inference